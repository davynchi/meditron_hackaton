# Smart Blood Analysis Dashboard

Интерактивный дашборд, созданный в рамках хакатона «Прототип системы умной визуализации данных биохимического анализатора» (кейс КРЭТ). Прототип демонстрирует, как лаборатории могут быстро исследовать результаты анализов, находить отклонения и предоставлять врачам сводки по каждому пациенту.

## Цели и задачи

Цель проекта — превратить разрозненные результаты анализов в удобный инструмент визуального контроля для врачей‑лаборантов. Для этого мы:

- **Сокращаем время интерпретации** результатов избранного пациента за счёт кликабельных карточек показателей и всплывающих графиков.
- **Выявляем отклонения** от референсных значений посредством цветных индикаторов (для гемоглобина и тромбоцитов) и подсветки диагностических меток.
- **Собираем историю анализов** из разных таблиц (`анализ_крови`, `анализ_мочи` и т.д.) в едином интерфейсе.
- **Обеспечиваем прозрачность данных**: пользователь всегда видит источник таблицы, дату сдачи анализа, а выбранные показатели можно сопоставить на связанных графиках и box‑plot.

## Реализованный функционал

- **Выбор пациента по ID.** После входа в систему пользователь выбирает ID и видит все строки из таблиц, связанные с этим пациентом.
- **Карточки показателей.** Каждая запись раскрывается в `<details>`: внутри показываются кликабельные карточки всех колонок, кроме служебных.
- **Индикаторы граничных значений.** Для гемоглобина и тромбоцитов наглядная строка с диапазоном нормы, маркером текущего значения и подписью границ.
- **История показателей.** Нажатие на индикатор открывает пустой/исторический график Plotly с датами по оси X и значениями выбранной метрики по оси Y, дополненный красными линиями норм.
- **Box‑plot и scatter.** Глобальные графики (boxplot по полу и scatter эритроциты/гемоглобин) работают для всего набора данных.
- **Визуальные статусы анализа мочи.** Карточка «Диагноз» подсвечивается зелёным (NEGATIVE) или красным (POSITIVE).

## Стек

- Python 3.11+
- Dash + Plotly
- Pandas

## Входные данные

- Каталог `data/`, содержащий CSV/XLSX таблицы. Для `анализ_крови.*` автоматически учитывается разделитель `;`.
- У каждой строки должен быть столбец `ID`, а также поля `Имя`, `Пол`, `Дата`, измерения (`Гемоглобин`, `Тромбоциты`, …) и их референсные границы.

## Выходные данные

- Веб‑дашборд (Dash), показывающий карточки показателей, индикаторы отклонений, графики истории и summary‑графики (boxplot + scatter).
- Логи в консоли с адресом запуска (`http://127.0.0.1:8050/`).

## Инструкция по развертыванию и запуску

```bash
pip install -r requirements.txt  # или poetry install
python -m src.main
# или используйте скрипт
bash scripts/run_local.sh
```

Либо используйте Docker:

```bash
sudo systemctl enable docker
sudo docker build -t meditron .
sudo docker run --rm -it -p 8050:8050 meditron
# или
bash scripts/deploy_docker.sh
```

По умолчанию приложение доступно на `http://127.0.0.1:8050/`. Войти можно любыми значениями логина/пароля (валидатор требует лишь непустые поля).

## Как пользоваться

1. Откройте дашборд и выберите показатель в левом выпадающем списке — box-plot покажет распределение по полу и выбросы.
2. Выберите пациента в секции «Client Statistics» — карточки обновятся, отобразив все значения анализа.
3. Используйте scatter-график, чтобы оценить связь между эритроцитами и гемоглобином, видя возраст и пол в единой визуализации.

## Точки роста

- Добавить фильтры по дате, типу анализа и маркеру STAT.
- Ввести цветовое кодирование относительно референсных интервалов и подсветку критических значений.
- Реализовать временные ряды (sparkline/line-chart) для динамики по пациенту.
- Экспорт PDF/Excel для быстрых отчетов и интеграцию с внешними ЛИС через API.

## Почему решение подходит под требования кейса

- **Визуализации:** комбинирует box-plot, scatter и карточные компоненты с интуитивным управлением.
- **Фильтры:** уже реализован фильтр по показателю и пациенту, легко расширить до дат и типов анализов.
- **Сводные данные:** карточки пациента сразу подсвечивают, что происходит с ключевыми CBC-метриками.
- **UX:** экран использует аккуратную типографику, контрастные цвета и повторяемую структуру блоков.

## Документация и конфигурация

- Дополнительные сведения об архитектуре и ключевых алгоритмах: `docs/architecture.md`, `docs/main.md`, `docs/login.md`.
- Конфигурационные файлы: `config/settings.yaml` (боевые параметры) и `config/settings.example.yaml` (шаблон).
- Скрипты автоматизации расположены в `scripts/`: `run_local.sh` запускает приложение локально, `deploy_docker.sh` собирает и стартует Docker-образ.
